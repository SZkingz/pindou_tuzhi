<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试颜色库加载功能</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .color-item { display: flex; align-items: center; margin: 5px 0; }
        .color-preview { width: 20px; height: 20px; margin-right: 10px; border: 1px solid #000; }
        button { padding: 8px 15px; margin: 5px; cursor: pointer; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>测试颜色库加载功能</h1>
    
    <div class="test-section">
        <h2>1. 测试 colors.json 文件访问</h2>
        <button onclick="testJsonFile()">测试 colors.json 访问</button>
        <div id="jsonTestResult"></div>
    </div>
    
    <div class="test-section">
        <h2>2. 测试颜色库加载逻辑</h2>
        <button onclick="testColorLibraryLoad()">测试颜色库加载</button>
        <div id="colorLibraryResult"></div>
        <div id="colorDisplay"></div>
    </div>
    
    <div class="test-section">
        <h2>3. 本地存储管理</h2>
        <p>如果颜色库已保存到 localStorage，新的 colors.json 不会自动加载。您可以：</p>
        <button onclick="clearLocalStorage()">清除 localStorage 中的颜色库</button>
        <button onclick="showLocalStorage()">查看 localStorage 中的颜色库</button>
        <div id="localStorageResult"></div>
    </div>

    <script>
        // 测试 colors.json 文件是否可以正常访问
        function testJsonFile() {
            const resultDiv = document.getElementById('jsonTestResult');
            resultDiv.innerHTML = '<p>正在测试 colors.json 文件访问...</p>';
            
            fetch('colors.json')
                .then(response => {
                    if (response.ok) {
                        return response.json();
                    } else {
                        throw new Error(`HTTP错误！状态：${response.status}`);
                    }
                })
                .then(data => {
                    resultDiv.innerHTML = `<p class="success">✅ colors.json 文件访问成功！</p>
                                          <p>文件包含 ${data.length} 个颜色分组。</p>`;
                })
                .catch(error => {
                    resultDiv.innerHTML = `<p class="error">❌ colors.json 文件访问失败：${error.message}</p>`;
                });
        }
        
        // 测试颜色库加载逻辑
        function testColorLibraryLoad() {
            const resultDiv = document.getElementById('colorLibraryResult');
            const displayDiv = document.getElementById('colorDisplay');
            
            resultDiv.innerHTML = '<p>正在测试颜色库加载...</p>';
            displayDiv.innerHTML = '';
            
            // 模拟颜色库加载逻辑
            fetch('colors.json')
                .then(response => response.json())
                .then(colorCategories => {
                    resultDiv.innerHTML = `<p class="success">✅ 颜色库加载成功！</p>
                                          <p>共 ${colorCategories.length} 个颜色分组：</p>`;
                    
                    // 显示颜色分组
                    colorCategories.forEach(category => {
                        const categoryDiv = document.createElement('div');
                        categoryDiv.innerHTML = `<h4>${category.name} (ID: ${category.id})</h4>
                                               <p>包含 ${category.colors.length} 种颜色：</p>`;
                        
                        // 显示颜色列表
                        const colorsList = document.createElement('div');
                        category.colors.forEach(color => {
                            const colorItem = document.createElement('div');
                            colorItem.className = 'color-item';
                            colorItem.innerHTML = `<div class="color-preview" style="background-color: ${color.color}"></div>
                                                 ${color.name}: ${color.color}`;
                            colorsList.appendChild(colorItem);
                        });
                        
                        categoryDiv.appendChild(colorsList);
                        displayDiv.appendChild(categoryDiv);
                    });
                })
                .catch(error => {
                    resultDiv.innerHTML = `<p class="error">❌ 颜色库加载失败：${error.message}</p>`;
                });
        }
        
        // 清除 localStorage 中的颜色库
        function clearLocalStorage() {
            const resultDiv = document.getElementById('localStorageResult');
            localStorage.removeItem('colorCategories');
            resultDiv.innerHTML = '<p class="success">✅ 已清除 localStorage 中的颜色库数据！</p>';
        }
        
        // 显示 localStorage 中的颜色库
        function showLocalStorage() {
            const resultDiv = document.getElementById('localStorageResult');
            const savedCategories = localStorage.getItem('colorCategories');
            
            if (savedCategories) {
                const data = JSON.parse(savedCategories);
                resultDiv.innerHTML = `<p class="success">✅ localStorage 中存在颜色库数据！</p>
                                      <p>包含 ${data.length} 个颜色分组。</p>`;
            } else {
                resultDiv.innerHTML = '<p class="error">❌ localStorage 中没有颜色库数据。</p>';
            }
        }
        
        // 页面加载时自动测试
        window.onload = function() {
            testJsonFile();
        };
    </script>
</body>
</html>